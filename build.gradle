plugins {
    id "org.jetbrains.kotlin.jvm" version "1.1.4-2"
    // need to use Gretty here because of https://github.com/johndevs/gradle-vaadin-plugin/issues/317
    id "org.akhikhl.gretty" version "2.0.0"
    id 'com.devsoap.plugin.vaadin' version '1.2.1'
}
apply plugin: 'war'

vaadin {
    version '8.1.2'
//    manageDependencies = false  // must be true otherwise Intellij reimport won't work:
    // https://github.com/johndevs/gradle-vaadin-plugin/issues/451
//    logToConsole = true
//    vaadinRun {
//        server = 'jetty'
//    }
}

gretty {
    contextPath = '/'
}

defaultTasks 'clean', 'build'

repositories {
    mavenCentral()
    jcenter()
    maven { url 'http://maven.vaadin.com/vaadin-addons' }
    maven { url 'https://maven.vaadin.com/vaadin-prereleases' }
    maven { url "https://dl.bintray.com/mvysny/vaadin-on-kotlin" }
}

dependencies {
    // Karibu-DSL dependency
    compile 'com.github.vok.karibudsl:karibu-dsl-v8:0.2.8'

    // Vaadin - has to be here even though vaadin.manageDependencies is true:
    // Gretty won't pull in Vaadin dependencies on appRun and will crash because of missing widgetset
    compile "com.vaadin:vaadin-client-compiled:${vaadin.version}"
    compile "com.vaadin:vaadin-server:${vaadin.version}"
    compile "com.vaadin:vaadin-themes:${vaadin.version}"
    providedCompile 'javax.servlet:javax.servlet-api:3.1.0'
}
